---
import SidebarLayout from '../layouts/SidebarLayout.astro';
import { book } from '../data/books/piltdown-man';
import { catalog } from '../data/catalog';
import { volumes, icons } from '../data/volumes';

const stripeUrl = import.meta.env.PUBLIC_STRIPE_BUY_URL;

// Group all books by volume
const volumeGroups = new Map<number, { name: string; books: typeof catalog }>();
for (const b of catalog) {
  if (!volumeGroups.has(b.volumeNum)) {
    volumeGroups.set(b.volumeNum, { name: b.volume, books: [] });
  }
  volumeGroups.get(b.volumeNum)!.books.push(b);
}
const sortedVolumes = [...volumeGroups.entries()].sort((a, b) => a[0] - b[0]);

// Volume metadata lookup
const volumeLookup = new Map(volumes.map(v => [v.num, v]));
---

<SidebarLayout
  title="Non-Fiction History Ebooks — Mysteries, Conspiracies & Cold Cases"
  description="33 narrative non-fiction ebooks about history's darkest mysteries. MKUltra, Jack the Ripper, Illuminati, Area 51 & more. Free EPUB download + $2.99 books."
  image="/books/covers/piltdown-man.jpg"
  maxWidth="1200px"
  keywords="history ebooks, non-fiction ebooks, conspiracy books, MKUltra book, cold case books, mystery ebooks, historical mysteries, secret societies books, true crime ebooks, declassified documents, free history ebook"
>
  <div class="landing">

    <!-- =============================================
         HERO — Free book + email capture
         ============================================= -->
    <section class="hero">
      <div class="hero-glow"></div>

      <div class="hero-inner">
        <div class="hero-cover">
          <div class="cover-wrapper">
            <img
              src="/books/covers/piltdown-man.jpg"
              alt="The Piltdown Men book cover"
              width="480"
              height="720"
              loading="eager"
            />
            <div class="cover-shine"></div>
          </div>
        </div>

        <div class="hero-text">
          <span class="series-badge">
            <span class="badge-dot"></span>
            Free Book
          </span>

          <h1>The Piltdown<br/>Men</h1>
          <p class="hero-subtitle">{book.subtitle}</p>

          <p class="hero-desc">{book.description}</p>

          <div class="hero-stats">
            <div class="stat">
              <span class="stat-value">1912</span>
              <span class="stat-label">Discovered</span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat">
              <span class="stat-value">41</span>
              <span class="stat-label">Years Hidden</span>
            </div>
            <div class="stat-divider"></div>
            <div class="stat">
              <span class="stat-value">15</span>
              <span class="stat-label">Chapters</span>
            </div>
          </div>

          <!-- Email form -->
          <div class="hero-form-wrapper" id="formWrapper">
            <form id="freeBookForm">
              <input
                type="email"
                name="email"
                placeholder="your@email.com"
                required
                autocomplete="email"
                class="form-input"
              />
              <button type="submit" class="form-btn">
                <span class="btn-text">Get Free Book</span>
                <span class="btn-loading" style="display: none;">
                  <svg class="spinner" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" stroke-dasharray="60" stroke-dashoffset="20"/>
                  </svg>
                </span>
              </button>
            </form>
            <p class="form-note">Free. No payment needed. We'll also send you new releases.</p>
          </div>

          <div class="hero-download" id="downloadState" style="display: none;">
            <a href="/books/piltdown-man.epub" class="download-btn" download="The-Piltdown-Men.epub">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"/>
              </svg>
              Download Free EPUB
            </a>
            <p class="download-note">DRM-free. Reads on any device.</p>
          </div>

          <a href="/cases/piltdown-man" class="hero-preview-link">
            or read the case file online →
          </a>
        </div>
      </div>
    </section>

    <!-- =============================================
         TRANSITION — Bridge to catalog
         ============================================= -->
    <section class="bridge">
      <div class="bridge-divider">
        <div class="bridge-line"></div>
        <div class="bridge-icon">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 2L2 9l2 12h16l2-12L12 2zm0 3.5L17.5 9h-11L12 5.5z"/>
          </svg>
        </div>
        <div class="bridge-line"></div>
      </div>
      <p class="bridge-text">First one's on us. Then explore <strong>{catalog.length} more</strong> across <strong>{sortedVolumes.length} volumes</strong>.</p>
    </section>

    <!-- =============================================
         KINDLE BANNER
         ============================================= -->
    <section class="kindle-banner fade-in">
      <a href="https://www.amazon.com/s?i=digital-text&rh=p_27%3AHistorIQly" target="_blank" rel="noopener" class="kindle-link">
        <div class="kindle-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
          </svg>
        </div>
        <div class="kindle-text">
          <span class="kindle-label">Now available on Amazon Kindle</span>
          <span class="kindle-desc">10 titles live — $2.99 each</span>
        </div>
        <span class="kindle-arrow">Browse on Amazon →</span>
      </a>
    </section>

    <!-- =============================================
         CATALOG — Volume cards
         ============================================= -->
    <section class="catalog">
      <div class="catalog-header">
        <h2>The Collection</h2>
        <p class="catalog-lead">Narrative non-fiction. Each book is a deep-dive into one of history's strangest stories. <strong>$2.99 each</strong> on Amazon Kindle.</p>
      </div>

      <div class="vol-grid">
        {sortedVolumes.map(([num, vol]) => {
          const meta = volumeLookup.get(num);
          if (!meta) return null;
          return (
            <a href={`/vol/${meta.slug}`} class="vol-card fade-in">
              <div class="vol-card-covers">
                {vol.books.slice(0, 3).map((b) => (
                  <img
                    src={`/books/covers/${b.slug}.jpg`}
                    alt={`${b.title} — ${b.subtitle} | Non-fiction ebook`}
                    class="vol-card-thumb"
                    width="120"
                    height="180"
                    loading="lazy"
                  />
                ))}
              </div>
              <div class="vol-card-body">
                <div class="vol-card-meta">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="vol-card-icon" set:html={icons[meta.icon]} />
                  <span class="vol-card-num">Vol. {num}</span>
                </div>
                <h3 class="vol-card-title">{vol.name}</h3>
                <p class="vol-card-tagline">{meta.tagline}</p>
                <span class="vol-card-cta">{vol.books.length} {vol.books.length === 1 ? 'book' : 'books'} →</span>
              </div>
            </a>
          );
        })}
      </div>
    </section>

  </div>
</SidebarLayout>

<script>
  const formWrapper = document.getElementById('formWrapper');
  const downloadState = document.getElementById('downloadState');
  const form = document.getElementById('freeBookForm') as HTMLFormElement;

  // Returning visitor — show download
  if (localStorage.getItem('historiqly_free_book_claimed') === 'true') {
    if (formWrapper) formWrapper.style.display = 'none';
    if (downloadState) downloadState.style.display = 'block';
  }

  // Email form submit
  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(form);
    const email = formData.get('email') as string;
    const btn = form.querySelector('.form-btn') as HTMLButtonElement;
    const btnText = btn.querySelector('.btn-text') as HTMLElement;
    const btnLoading = btn.querySelector('.btn-loading') as HTMLElement;

    btn.disabled = true;
    btnText.style.display = 'none';
    btnLoading.style.display = 'flex';

    try {
      const apiBase = window.location.hostname === 'localhost'
        ? 'http://localhost:3000'
        : 'https://app.historiqly.com';

      await fetch(`${apiBase}/api/books/subscribe`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, source: 'free-book' }),
      });

      localStorage.setItem('historiqly_free_book_claimed', 'true');

      if (formWrapper) formWrapper.style.display = 'none';
      if (downloadState) downloadState.style.display = 'block';
    } catch (error) {
      // Still show the download even if API fails — don't block the user
      localStorage.setItem('historiqly_free_book_claimed', 'true');
      if (formWrapper) formWrapper.style.display = 'none';
      if (downloadState) downloadState.style.display = 'block';
    }
  });

  // Scroll fade-in animation
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

  document.querySelectorAll('.fade-in').forEach((el) => observer.observe(el));
</script>

<style>
  .landing {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  /* ============================================
     HERO
     ============================================ */
  .hero {
    padding: 2rem 0 1rem;
    position: relative;
    width: 100%;
    margin-bottom: 3rem;
    overflow: hidden;
  }

  .hero-glow {
    position: absolute;
    top: -100px;
    left: 50%;
    transform: translateX(-50%);
    width: 120%;
    height: 600px;
    background: radial-gradient(ellipse at center, rgba(93, 181, 133, 0.15) 0%, transparent 60%);
    pointer-events: none;
    filter: blur(80px);
    z-index: 0;
    opacity: 0.6;
    animation: glow-pulse 8s ease-in-out infinite alternate;
  }

  @keyframes glow-pulse {
    0% { opacity: 0.5; transform: translateX(-50%) scale(1); }
    100% { opacity: 0.8; transform: translateX(-50%) scale(1.1); }
  }

  .hero-inner {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 4rem;
    align-items: center;
    position: relative;
    z-index: 1;
    background: rgba(20, 20, 20, 0.6);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 32px;
    padding: 3rem;
    box-shadow: 
      0 4px 30px rgba(0,0,0,0.3),
      inset 0 0 0 1px rgba(255,255,255,0.05);
  }

  /* Cover */
  .hero-cover {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .cover-wrapper {
    position: relative;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 20px 40px -10px rgba(0,0,0,0.6);
    transition: transform 0.3s ease;
    max-width: 280px;
    width: 100%;
    animation: float 6s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  .cover-wrapper:hover {
    animation-play-state: paused;
    transform: translateY(-5px) scale(1.02);
    box-shadow: 0 25px 50px -12px rgba(0,0,0,0.7);
  }

  .cover-wrapper img {
    display: block;
    width: 100%;
    height: auto;
    aspect-ratio: 2 / 3;
    object-fit: cover;
  }

  .cover-shine {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      115deg,
      transparent 40%,
      rgba(255, 255, 255, 0.1) 45%,
      rgba(255, 255, 255, 0.2) 50%,
      rgba(255, 255, 255, 0.1) 55%,
      transparent 60%
    );
    pointer-events: none;
    mix-blend-mode: overlay;
  }

  /* Text */
  .hero-text {
    display: flex;
    flex-direction: column;
  }

  .series-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.35rem 0.85rem;
    background: rgba(93, 181, 133, 0.1);
    border: 1px solid rgba(93, 181, 133, 0.3);
    border-radius: 100px;
    font-size: 0.7rem;
    font-weight: 700;
    color: #5DB585;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 1rem;
    width: fit-content;
    box-shadow: 0 0 15px rgba(93, 181, 133, 0.1);
  }

  .badge-dot {
    width: 6px;
    height: 6px;
    background: #5DB585;
    border-radius: 50%;
    box-shadow: 0 0 8px #5DB585;
    animation: pulse-dot 2s ease-in-out infinite;
  }

  @keyframes pulse-dot {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.2); }
  }

  .hero h1 {
    font-size: clamp(2.5rem, 5vw, 4rem);
    font-weight: 800;
    letter-spacing: -0.04em;
    line-height: 1.05;
    margin-bottom: 0.75rem;
    background: linear-gradient(180deg, #fff 0%, #a0a0a0 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 0 10px 30px rgba(0,0,0,0.2);
  }

  .hero-subtitle {
    font-size: 1.35rem;
    color: #888;
    font-style: italic;
    margin-bottom: 1.25rem;
    letter-spacing: 0.01em;
  }

  .hero-desc {
    font-size: 1.15rem;
    color: #b0b0b0;
    line-height: 1.7;
    margin-bottom: 2.5rem;
    max-width: 640px;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Stats */
  .hero-stats {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    margin-bottom: 2rem;
    padding: 0.75rem 1.25rem;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 12px;
    width: fit-content;
    backdrop-filter: blur(5px);
  }

  .stat {
    display: flex;
    flex-direction: column;
    gap: 0.2rem;
  }

  .stat-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: #fff;
    line-height: 1;
  }

  .stat-label {
    font-size: 0.6rem;
    font-weight: 600;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .stat-divider {
    width: 1px;
    height: 24px;
    background: rgba(255, 255, 255, 0.1);
  }

  /* Hero form */
  .hero-form-wrapper {
    max-width: 480px;
    position: relative;
    z-index: 2;
  }

  .hero-form-wrapper form {
    display: flex;
    gap: 0.75rem;
    position: relative;
    background: rgba(0,0,0,0.3);
    padding: 0.5rem;
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.08);
  }

  .form-input {
    flex: 1;
    padding: 0.75rem 1rem;
    background: transparent;
    border: none;
    color: #fff;
    font-size: 1rem;
    font-family: inherit;
    transition: all 0.2s ease;
  }
  
  .form-input::placeholder { color: #555; }

  .form-input:focus {
    outline: none;
  }

  .form-btn {
    padding: 0.75rem 1.5rem;
    background: #5DB585;
    color: #0a0a0a;
    font-weight: 700;
    font-size: 0.95rem;
    font-family: inherit;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: auto;
    box-shadow: 0 4px 15px rgba(93, 181, 133, 0.2);
  }

  .form-btn:hover:not(:disabled) {
    background: #6fc494;
    transform: translateY(-1px);
    box-shadow: 0 6px 20px rgba(93, 181, 133, 0.3);
  }

  .form-btn:disabled { opacity: 0.8; cursor: not-allowed; }

  .btn-loading { display: flex; align-items: center; justify-content: center; }

  .spinner { width: 20px; height: 20px; animation: spin 1s linear infinite; }

  @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

  .form-note {
    font-size: 0.75rem;
    color: #666;
    margin-top: 0.75rem;
    padding-left: 0.5rem;
  }

  /* Preview link */
  .hero-preview-link {
    font-size: 0.875rem;
    color: #666;
    margin-top: 1rem;
    display: inline-block;
    padding-left: 0.5rem;
    transition: color 0.2s;
  }

  .hero-preview-link:hover {
    color: #5DB585;
  }

  /* Download state */
  .download-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.6rem;
    padding: 1rem 2rem;
    background: #5DB585;
    color: #0a0a0a;
    font-weight: 700;
    font-size: 1rem;
    border-radius: 12px;
    text-decoration: none;
    transition: all 0.25s;
    box-shadow: 0 0 25px rgba(93, 181, 133, 0.2);
  }

  .download-btn:hover {
    background: #6FC494;
    transform: translateY(-2px);
    box-shadow: 0 5px 35px rgba(93, 181, 133, 0.3);
  }

  .download-note {
    font-size: 0.75rem;
    color: #666;
    margin-top: 0.75rem;
  }

  /* ============================================
     BRIDGE
     ============================================ */
  .bridge {
    text-align: center;
    padding: 1.5rem 0 1rem;
    position: relative;
    z-index: 2;
  }

  .bridge-divider {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin: 0 auto 1rem;
    max-width: 140px;
    opacity: 0.6;
  }

  .bridge-line {
    flex: 1;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(93, 181, 133, 0.2), transparent);
  }

  .bridge-icon {
    color: #5DB585;
    opacity: 0.4;
    display: flex;
    align-items: center;
  }

  .bridge-text {
    font-size: 1.125rem;
    color: #888;
    letter-spacing: -0.01em;
  }

  .bridge-text strong {
    color: #fff;
    font-weight: 600;
    text-shadow: 0 0 20px rgba(93, 181, 133, 0.2);
  }

  /* ============================================
     KINDLE BANNER
     ============================================ */
  .kindle-banner { margin-bottom: 2.5rem; }
  .kindle-link { display: flex; align-items: center; gap: 1.25rem; padding: 1.25rem 2rem; background: linear-gradient(135deg, rgba(255, 153, 0, 0.08) 0%, rgba(255, 153, 0, 0.03) 100%); border: 1px solid rgba(255, 153, 0, 0.2); border-radius: 16px; text-decoration: none; color: inherit; transition: all 0.3s ease; }
  .kindle-link:hover { background: linear-gradient(135deg, rgba(255, 153, 0, 0.12) 0%, rgba(255, 153, 0, 0.06) 100%); border-color: rgba(255, 153, 0, 0.4); transform: translateY(-2px); box-shadow: 0 8px 24px rgba(255, 153, 0, 0.1); }
  .kindle-icon { display: flex; align-items: center; justify-content: center; width: 48px; height: 48px; background: rgba(255, 153, 0, 0.12); border-radius: 12px; color: #FF9900; flex-shrink: 0; }
  .kindle-text { display: flex; flex-direction: column; gap: 0.2rem; flex: 1; }
  .kindle-label { font-size: 1rem; font-weight: 700; color: #fff; }
  .kindle-desc { font-size: 0.8125rem; color: #888; }
  .kindle-arrow { font-size: 0.875rem; font-weight: 600; color: #FF9900; white-space: nowrap; transition: transform 0.2s; }
  .kindle-link:hover .kindle-arrow { transform: translateX(4px); }

  /* ============================================
     CATALOG
     ============================================ */
  .catalog {
    padding: 0 0 6rem;
  }

  .catalog-header {
    margin-bottom: 3rem;
    text-align: center;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  .catalog-header h2 {
    font-size: 2.5rem;
    font-weight: 800;
    letter-spacing: -0.03em;
    margin-bottom: 1rem;
    background: linear-gradient(180deg, #fff 0%, #aaa 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .catalog-lead {
    font-size: 1.1rem;
    color: #888;
    line-height: 1.6;
  }

  .catalog-lead strong {
    color: #fff;
    font-weight: 600;
  }

  /* ============================================
     VOLUME CARD GRID
     ============================================ */
  .vol-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }

  @media (min-width: 1400px) {
    .vol-grid {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  .vol-card {
    display: flex;
    flex-direction: column;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 20px;
    overflow: hidden;
    text-decoration: none;
    color: inherit;
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    position: relative;
    height: 100%;
  }

  .vol-card::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 20px;
    padding: 1px;
    background: linear-gradient(180deg, rgba(255,255,255,0.1), transparent); 
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    pointer-events: none;
    opacity: 0.5;
    transition: opacity 0.4s ease;
  }

  .vol-card:hover {
    background: rgba(255, 255, 255, 0.06);
    transform: translateY(-8px);
    box-shadow: 
      0 20px 40px -5px rgba(0,0,0,0.4),
      0 0 0 1px rgba(93, 181, 133, 0.2);
  }

  .vol-card:hover::before {
    opacity: 1;
    background: linear-gradient(180deg, rgba(93, 181, 133, 0.3), transparent);
  }

  /* Fanned book covers */
  .vol-card-covers {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 2.5rem 0 2rem;
    height: 180px;
    perspective: 1000px;
    position: relative;
  }
  
  .vol-card-covers::after {
    content: '';
    position: absolute;
    bottom: 2rem;
    left: 50%;
    transform: translateX(-50%);
    width: 60%;
    height: 20px;
    background: radial-gradient(ellipse at center, rgba(0,0,0,0.4) 0%, transparent 70%);
    filter: blur(5px);
    z-index: 0;
    opacity: 0;
    transition: opacity 0.4s ease;
  }

  .vol-card:hover .vol-card-covers::after {
    opacity: 1;
  }

  .vol-card-thumb {
    width: 80px;
    height: 120px;
    object-fit: cover;
    border-radius: 6px;
    box-shadow: -4px 6px 15px rgba(0,0,0,0.5);
    transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    margin: 0 -10px;
    transform-origin: bottom center;
    position: relative;
  }

  .vol-card-thumb:nth-child(1) {
    transform: rotate(-8deg) translateY(6px);
    z-index: 1;
    filter: brightness(0.8);
  }

  .vol-card-thumb:nth-child(2) {
    transform: translateY(-4px) scale(1.1);
    z-index: 2;
    box-shadow: 0 10px 20px rgba(0,0,0,0.6);
  }

  .vol-card-thumb:nth-child(3) {
    transform: rotate(8deg) translateY(6px);
    z-index: 1;
    filter: brightness(0.8);
  }

  .vol-card:hover .vol-card-thumb:nth-child(1) {
    transform: rotate(-12deg) translateY(2px) translateX(-15px);
    filter: brightness(1);
  }

  .vol-card:hover .vol-card-thumb:nth-child(2) {
    transform: translateY(-12px) scale(1.15);
  }

  .vol-card:hover .vol-card-thumb:nth-child(3) {
    transform: rotate(12deg) translateY(2px) translateX(15px);
    filter: brightness(1);
  }

  /* Card body */
  .vol-card-body {
    padding: 0.5rem 1.5rem 1.75rem;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    flex-grow: 1;
  }

  .vol-card-meta {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
    padding: 0.25rem 0.6rem;
    background: rgba(0,0,0,0.2);
    border-radius: 100px;
  }

  .vol-card-icon {
    width: 14px;
    height: 14px;
    color: #5DB585;
    opacity: 0.9;
  }

  .vol-card-num {
    font-size: 0.65rem;
    font-weight: 700;
    color: #5DB585;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  .vol-card-title {
    font-size: 1.25rem;
    font-weight: 700;
    color: #fff;
    margin-bottom: 0.4rem;
    line-height: 1.2;
    transition: color 0.3s;
  }

  .vol-card:hover .vol-card-title {
    color: #5DB585;
  }

  .vol-card-tagline {
    font-size: 0.875rem;
    color: #888;
    font-style: italic;
    margin-bottom: 1.25rem;
    line-height: 1.4;
    flex-grow: 1;
  }

  .vol-card-cta {
    font-size: 0.8125rem;
    font-weight: 700;
    color: #fff;
    background: rgba(255,255,255,0.08);
    padding: 0.5rem 1rem;
    border-radius: 8px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }

  .vol-card:hover .vol-card-cta {
    background: #5DB585;
    color: #0a0a0a;
    transform: translateY(2px);
  }

  /* Fade-in animation */
  .fade-in {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
  }

  .fade-in.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* ============================================
     RESPONSIVE
     ============================================ */
  @media (max-width: 768px) {
    .hero {
      padding: 1rem 1rem 2rem;
    }

    .hero-inner {
      grid-template-columns: 1fr;
      gap: 1.5rem;
      text-align: center;
      padding: 1.5rem;
    }

    .hero-cover {
      order: -1;
      margin-bottom: 0.5rem;
    }

    .cover-wrapper {
      max-width: 140px;
      margin: 0 auto;
      box-shadow: 0 8px 16px rgba(0,0,0,0.4);
    }

    .hero-text {
      align-items: center;
    }

    .series-badge,
    .hero-stats,
    .hero-form-wrapper,
    .hero-download {
      margin-left: auto;
      margin-right: auto;
    }
    
    .hero-desc {
      -webkit-line-clamp: 4;
    }

    .hero-preview-link {
      text-align: center;
      display: block;
    }

    .hero-form-wrapper { width: 100%; }

    .hero h1 {
      font-size: 2rem;
    }

    .vol-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .kindle-link { flex-wrap: wrap; padding: 1rem 1.25rem; gap: 0.75rem; }
    .kindle-arrow { width: 100%; text-align: center; padding-top: 0.5rem; border-top: 1px solid rgba(255, 153, 0, 0.1); }
  }

  @media (max-width: 540px) {
    .hero-form-wrapper form {
      flex-direction: column;
    }

    .form-btn { width: 100%; }

    .vol-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 0.75rem;
    }

    .vol-card-covers {
      height: 115px;
      padding: 1.25rem 0 0.5rem;
    }

    .vol-card-thumb {
      width: 54px;
      height: 81px;
    }

    .vol-card-title {
      font-size: 0.875rem;
    }

    .vol-card-tagline {
      display: none;
    }
  }
</style>
