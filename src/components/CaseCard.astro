---
import type { Case } from "../data/types";

interface Props {
  case: Case;
  isLocked: boolean;
  isNew: boolean;
}

const { case: caseData, isLocked, isNew } = Astro.props;
const caseNum = String(caseData.caseNumber).padStart(2, "0");
---

<div class:list={["case-card", { locked: isLocked }]}>
  <div class="case-header">
    <span class="case-num">{caseNum}</span>
    {caseData.isFree && <span class="free-badge">Free Preview Coming Soon</span>}
    {isNew && <span class="new-badge">New</span>}
    {
      isLocked ? (
        <span class="locked-badge">
          <svg
            width="12"
            height="12"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
          </svg>
          Coming Soon
        </span>
      ) : (
        <div class={`case-verdict ${caseData.verdictType}`}>
          {caseData.verdictLabel}
        </div>
      )
    }
  </div>

  <h3>{caseData.title}</h3>

  {
    isLocked ? (
      <p class="locked-description">
        This investigation is not yet available.
      </p>
    ) : (
      <>
        <p>{caseData.description}</p>
        <div class="case-meta">
          <span class="meta-item">
            <span class="meta-label">Year</span>
            <span class="meta-value">{caseData.year}</span>
          </span>
          <span class="meta-divider"></span>
          <span class="meta-item">
            <span class="meta-label">Confidence</span>
            <span class="meta-value highlight">{caseData.confidence}%</span>
          </span>
        </div>
      </>
    )
  }
</div>

<style>
  .case-card {
    background: linear-gradient(180deg, #131313 0%, #0f0f0f 100%);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 14px;
    padding: 1.5rem;
    transition: all 0.3s;
    margin-bottom: 0.75rem;
  }

  .case-card:hover {
    border-color: rgba(93, 181, 133, 0.25);
    transform: translateY(-1px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
  }

  .case-card.locked {
    opacity: 0.6;
    background: linear-gradient(180deg, #0e0e0e 0%, #0b0b0b 100%);
    border-color: rgba(255, 255, 255, 0.04);
  }

  .case-card.locked:hover {
    border-color: rgba(93, 181, 133, 0.15);
    opacity: 0.75;
    transform: none;
    box-shadow: none;
  }

  .case-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.875rem;
  }

  .case-num {
    font-size: 0.75rem;
    font-weight: 800;
    color: #5db585;
    background: rgba(93, 181, 133, 0.1);
    padding: 0.3rem 0.5rem;
    border-radius: 6px;
    letter-spacing: 0.02em;
  }

  .new-badge {
    background: #22c55e;
    color: #000;
    font-size: 0.625rem;
    padding: 0.2rem 0.5rem;
    border-radius: 5px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.03em;
    animation: pulse 2s infinite;
  }

  .free-badge {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: #000;
    font-size: 0.625rem;
    padding: 0.25rem 0.5rem;
    border-radius: 5px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    animation: shimmer 2s infinite;
    box-shadow: 0 0 12px rgba(245, 158, 11, 0.3);
  }

  @keyframes shimmer {
    0%, 100% {
      opacity: 1;
      box-shadow: 0 0 12px rgba(245, 158, 11, 0.3);
    }
    50% {
      opacity: 0.9;
      box-shadow: 0 0 20px rgba(245, 158, 11, 0.5);
    }
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  .locked-badge {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-size: 0.6875rem;
    color: #555;
    padding: 0.25rem 0.625rem;
    background: rgba(255, 255, 255, 0.04);
    border-radius: 5px;
    margin-left: auto;
  }

  .case-verdict {
    font-size: 0.6875rem;
    padding: 0.25rem 0.625rem;
    border-radius: 5px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    margin-left: auto;
  }

  .case-verdict.confirmed_hoax,
  .case-verdict.propaganda_forgery {
    background: rgba(239, 68, 68, 0.12);
    color: #f87171;
  }

  .case-verdict.scientific_fraud,
  .case-verdict.literary_fraud {
    background: rgba(251, 146, 60, 0.12);
    color: #fb923c;
  }

  .case-verdict.photo_manipulation {
    background: rgba(168, 85, 247, 0.12);
    color: #a855f7;
  }

  .case-verdict.myth_debunked,
  .case-verdict.cold_case,
  .case-verdict.unexplained {
    background: rgba(59, 130, 246, 0.12);
    color: #60a5fa;
  }

  .case-verdict.disappearance {
    background: rgba(168, 85, 247, 0.12);
    color: #c084fc;
  }

  .case-verdict.conspiracy {
    background: rgba(251, 146, 60, 0.12);
    color: #fbbf24;
  }

  .case-verdict.secret_society {
    background: rgba(59, 130, 246, 0.12);
    color: #60a5fa;
  }

  .case-verdict.declassified {
    background: rgba(34, 197, 94, 0.12);
    color: #4ade80;
  }

  .case-verdict.lost_civilization,
  .case-verdict.archaeological {
    background: rgba(212, 160, 23, 0.12);
    color: #fbbf24;
  }

  h3 {
    font-size: 1.125rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: #fafafa;
    letter-spacing: -0.01em;
  }

  p {
    font-size: 0.9375rem;
    color: #999;
    line-height: 1.65;
    margin-bottom: 1rem;
  }

  .locked-description {
    color: #555;
    font-style: italic;
  }

  .case-meta {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding-top: 0.875rem;
    border-top: 1px solid rgba(255, 255, 255, 0.04);
  }

  .meta-item {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
  }

  .meta-label {
    font-size: 0.6875rem;
    color: #555;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    font-weight: 600;
  }

  .meta-value {
    font-size: 0.875rem;
    color: #bbb;
    font-weight: 600;
  }

  .meta-divider {
    width: 1px;
    height: 28px;
    background: rgba(255, 255, 255, 0.06);
  }

  .highlight {
    color: #5db585;
  }
</style>
