---
import type { Case } from "../data/types";

interface Props {
  case: Case;
  isLocked: boolean;
  isNew: boolean;
}

const { case: caseData, isLocked, isNew } = Astro.props;
const caseNum = String(caseData.caseNumber).padStart(2, "0");
---

<div class:list={["case-card", { locked: isLocked }]}>
  <div class="case-header">
    <span class="case-num">{caseNum}</span>
    {caseData.isFree && <span class="free-badge">Free Preview Coming Soon</span>}
    {isNew && <span class="new-badge">New</span>}
    {
      isLocked ? (
        <span class="locked-badge">
          <svg
            width="12"
            height="12"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
            <path d="M7 11V7a5 5 0 0 1 10 0v4" />
          </svg>
          Subscriber Only
        </span>
      ) : (
        <div class={`case-verdict ${caseData.verdictType}`}>
          {caseData.verdictLabel}
        </div>
      )
    }
  </div>

  <h3>{caseData.title}</h3>

  {
    isLocked ? (
      <p class="locked-description">
        Subscribe to unlock this investigation and get full access to all 200
        casefiles.
      </p>
    ) : (
      <>
        <p>{caseData.description}</p>
        <div class="case-meta">
          <span>
            <strong>Year:</strong> {caseData.year}
          </span>
          <span>
            <strong>Confidence:</strong>{" "}
            <span class="highlight">{caseData.confidence}%</span>
          </span>
        </div>
      </>
    )
  }
</div>

<style>
  .case-card {
    background: #111;
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 10px;
    padding: 1.25rem;
    transition: all 0.2s;
    margin-bottom: 0.75rem;
  }

  .case-card:hover {
    border-color: rgba(93, 181, 133, 0.3);
  }

  .case-card.locked {
    opacity: 0.7;
    background: #0d0d0d;
    border-color: rgba(255, 255, 255, 0.05);
  }

  .case-card.locked:hover {
    border-color: rgba(93, 181, 133, 0.4);
    opacity: 0.85;
  }

  .case-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
  }

  .case-num {
    font-size: 0.75rem;
    font-weight: 700;
    color: #5db585;
    background: rgba(93, 181, 133, 0.1);
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
  }

  .new-badge {
    background: #22c55e;
    color: #000;
    font-size: 0.625rem;
    padding: 0.125rem 0.375rem;
    border-radius: 4px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    animation: pulse 2s infinite;
  }

  .free-badge {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: #000;
    font-size: 0.625rem;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    animation: shimmer 2s infinite;
    box-shadow: 0 0 12px rgba(245, 158, 11, 0.4);
  }

  @keyframes shimmer {
    0%, 100% {
      opacity: 1;
      box-shadow: 0 0 12px rgba(245, 158, 11, 0.4);
    }
    50% {
      opacity: 0.9;
      box-shadow: 0 0 20px rgba(245, 158, 11, 0.6);
    }
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.7;
    }
  }

  .locked-badge {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    font-size: 0.6875rem;
    color: #666;
    padding: 0.25rem 0.625rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
    margin-left: auto;
  }

  .case-verdict {
    font-size: 0.6875rem;
    padding: 0.25rem 0.625rem;
    border-radius: 4px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.02em;
    margin-left: auto;
  }

  .case-verdict.confirmed_hoax,
  .case-verdict.propaganda_forgery {
    background: rgba(239, 68, 68, 0.15);
    color: #f87171;
  }

  .case-verdict.scientific_fraud,
  .case-verdict.literary_fraud {
    background: rgba(251, 146, 60, 0.15);
    color: #fb923c;
  }

  .case-verdict.photo_manipulation {
    background: rgba(168, 85, 247, 0.15);
    color: #a855f7;
  }

  .case-verdict.myth_debunked,
  .case-verdict.cold_case,
  .case-verdict.unexplained {
    background: rgba(59, 130, 246, 0.15);
    color: #60a5fa;
  }

  h3 {
    font-size: 1.125rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: #fafafa;
  }

  p {
    font-size: 0.875rem;
    color: #a8a8a8;
    line-height: 1.6;
    margin-bottom: 0.75rem;
  }

  .locked-description {
    color: #666;
    font-style: italic;
  }

  .case-meta {
    display: flex;
    gap: 1.25rem;
    font-size: 0.8125rem;
    color: #888;
  }

  .case-meta strong {
    color: #a8a8a8;
  }

  .highlight {
    color: #5db585;
    font-weight: 600;
  }
</style>
